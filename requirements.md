# MicroRituals App

### Документ: `requirements.md`

## 1. Общая информация

**MicroRituals** — это мобильное приложение, которое помогает пользователям формировать полезные привычки (ритуалы) в коротком формате (5–10 минут) и вовлекает их в мини-челленджи, а также позволяет наблюдать за успехами других и давать «реакции» на их достижения. Приложение использует игровые механики (очки, достижения), а также социальные взаимодействия, чтобы мотивировать регулярное выполнение полезных действий.

### 1.1 Цели приложения
1. **Повышение мотивации**: помочь людям регулярно выполнять полезные привычки и отслеживать прогресс.
2. **Социальное взаимодействие**: предоставить пользователям возможность реагировать на достижения друг друга и делиться прогрессом.
3. **Удобство и простота**: минимализировать сложность интерфейса и настроек, чтобы пользователь тратил минимум времени на взаимодействие с приложением.
4. **Гибкая кастомизация**: позволить каждому создавать собственные ритуалы и формировать индивидуальную программу развития.

---

## 2. Основные функции (Key Features)

### 2.1 Регистрация и авторизация
- **OAuth / Email & Пароль**: возможность создать аккаунт с помощью почты и пароля или через социальные сети (Google / Facebook / Apple ID).
- **Восстановление пароля**: через почту или другие методы, в зависимости от выбранной системы авторизации.

### 2.2 Управление ритуалами (Habits / Routines)
- **Создание нового ритуала**: пользователь задаёт:
  - Название ритуала (например, «Зарядка 5 мин», «Чтение 10 мин»).
  - Короткое описание или цель.
  - Периодичность (ежедневно, будни/выходные, 3 раза в неделю и т.д.).
  - Напоминания (время суток, пуш-уведомления).
- **Редактирование ритуала**: пользователь может менять настройки ритуала (частоту, название, время уведомлений).
- **Удаление ритуала**: возможность полностью удалить ритуал или приостановить его.

### 2.3 Ежедневный чек-лист
- **Экран «Сегодня»**:
  - Показывает список ритуалов, которые нужно выполнить именно сегодня.
  - Короткое действие (тап/свайп) для отметки выполнения.
- **Отметка выполнения**:
  - Если пользователь отметил ритуал как выполненный, он получает +1 к текущей серии (streak), а также +N очков (зависит от настроек геймификации).
  - Можно добавить короткую заметку или комментарий (например, «Сегодня было тяжелее, чем обычно», «Крутая тренировка!»).

### 2.4 Очки и достижения (Gamification)
- **Очки**: 
  - Начисляются за выполнение ритуалов. 
  - Могут зависеть от сложности или продолжительности ритуала (например, 1 очко за каждое утреннее упражнение, 2 очка за 10 минут чтения и т.д.).
- **Достижения (Achievements)**:
  - Достижения за разные события:
    - **Streak**: «10 дней подряд»; «30 дней подряд».
    - **Суммарное количество выполнений**: «Сделал зарядку 50 раз».
    - **Тематика**: «30 дней подряд медитация» и т.п.
  - Визуальное отображение достижений в профиле (значок/бейдж).

### 2.5 Сообщество и социальные функции
- **Профиль пользователя**:
  - Количество очков, текущее количество выполненных ритуалов за сегодня/месяц.
  - Список полученных достижений.
  - «Лента» пользователя (выполненные задачи, публикации с комментариями).
- **Просмотр чужих профилей**:
  - Отображаются достижения другого пользователя, общее количество очков, список ритуалов (при желании можно скрывать некоторые ритуалы настройками приватности).
  - Кнопка «Подписаться» (если реализовываем модель подписок/друзей).
- **Лента активности (Feed)**:
  - Записи о выполненных ритуалах пользователей, на которых вы подписаны (или общий публичный поток).
  - Можно добавить фильтры (только ритуалы бега, только утренние ритуалы, только из моих групп).
- **Реакции**:
  - Пользователи могут ставить «лайк» или «эмодзи-реакцию» под чужими записями о выполненном ритуале.
  - Можно добавить короткий комментарий (до 140 символов).
  - Эти реакции отображаются в ленте пользователя и в его уведомлениях.

### 2.6 Уведомления
- **Push-уведомления**:
  - Напоминания о ритуалах (привязаны к конкретному времени суток).
  - Уведомления о комментариях и реакциях других людей на ваши записи.
  - Уведомления о полученных достижениях.
- **Внутренние уведомления**:
  - Всплывающие баннеры при достижении определённых целей (например, 7 дней подряд и т.д.).

### 2.7 Дополнительная геймификация (мини-челленджи)
- **Челленджи**:
  - Периодические задания, рассчитанные на нескольких пользователей (например, «7-дневный челлендж: делай 10 отжиманий и отмечай в приложении»).
  - Возможность присоединиться к челленджу, видеть прогресс других участников, реагировать на их успехи.
- **Награды за челленджи**:
  - Уникальные бейджи в профиле.
  - Дополнительные очки опыта.

### 2.8 Настройки приватности
- **Публичный / Приватный профиль**: пользователи решают, будет ли их профиль виден другим.
- **Приватные ритуалы**: возможность скрыть некоторые ритуалы от других людей (например, личные ритуалы по здоровью).

### 2.9 Монетизация
- **Бесплатная версия**:
  - Базовые функции: создание ритуалов, отметка выполнения, получение очков, ограниченное количество челленджей, реакций и т.д.
- **Премиум подписка**:
  - Расширенные отчёты и статистика (графики, подробный анализ прогресса).
  - Возможность создавать и участвовать в неограниченном количестве челленджей.
  - Эксклюзивные достижения / стикеры / оформление профиля.
  - Отключение рекламы (если используем рекламную модель).

---

## 3. Структура пользовательских экранов

1. **Экран приветствия (Onboarding)**:
   - Короткие слайды с описанием преимуществ приложения.
   - Регистрация / Авторизация.

2. **Главный экран**:
   - Верхняя панель с иконками для перехода к профилю/уведомлениям.
   - Блок «Сегодняшние ритуалы» (список ритуалов + кнопка «Выполнить»).
   - Блок «Активность друзей» (сниппет, при нажатии — переход в ленту).

3. **Лента (Feed)**:
   - Записи о выполненных ритуалах пользователей, на которых вы подписаны (или общий публичный поток).
   - Кнопка «Реакция» (эмодзи), кнопка «Комментарий».

4. **Экран создания/редактирования ритуала**:
   - Поля: Название, Частота, Время уведомления, Описание.
   - Кнопка «Сохранить».

5. **Экран челленджей**:
   - Список активных челленджей.
   - Возможность присоединиться/выйти.
   - Счётчик участников и прогресса.

6. **Профиль**:
   - Аватар, имя, количество очков, достижения в виде значков.
   - Личная лента пользователя: последние выполненные ритуалы (и количество «реакций» на них).
   - Кнопка «Редактировать профиль» (смена аватара, описания).

7. **Уведомления**:
   - Список последних уведомлений о реакциях, комментариях, новых челленджах, полученных достижениях.

8. **Меню настроек**:
   - Учетная запись: смена почты, пароля, привязка соцсетей.
   - Настройки приватности: публичный / приватный профиль, скрытые ритуалы.
   - Уведомления: выбор каких уведомлений и в какое время получать.
   - Информация о подписке (если есть платная модель).

---

## 4. Архитектура и технологии

### 4.1 Клиентская часть (Mobile)
- **Платформы**: Android и iOS (React Native + Expo).
- **Основные модули**:
  - **Экран аутентификации**.
  - **Экран списка ритуалов + выполнения**.
  - **Социальная лента, реакции**.
  - **Профиль** и **редактирование профиля**.
  - **Челленджи**.
  - **Уведомления**.
  - **Настройки**.
- **Уведомления**: Firebase Cloud Messaging (FCM) или Apple Push Notification Service / Google Push Notification Service.

### 4.2 Серверная часть (Backend)
- **Стек**: Node.js + Nest.js
  - Nest.js предоставляет структурированный подход к созданию модульного и легко поддерживаемого кода.
  - Поддержка TypeScript «из коробки» упрощает типизацию при работе с React Native + TypeScript.
  - Гибкая настройка роутинга и middleware.

### 4.3 База данных
- **Тип**: PostgreSQL
  - Реляционная СУБД с хорошей производительностью и надёжностью.
  - Хорошо интегрируется с Nest.js через ORM (TypeORM или Prisma).
  - Поддерживает транзакции, внешние ключи и богатый набор типов данных.

- **Основные сущности**:
  1. `users` (пользователи): поля `id`, `username`, `email`, `passwordHash`, `score`, `achievements[]`, ...
  2. `rituals` (ритуалы): поля `id`, `userId`, `title`, `description`, `frequency`, `timeOfDay`, `private` (bool), ...
  3. `completions` (выполнения): поля `id`, `userId`, `ritualId`, `date`, `streakCount`, `comment`, ...
  4. `achievements` (достижения): поля `id`, `userId`, `type`, `value`, `dateReceived`, ...
  5. `challenges` (челленджи): поля `id`, `title`, `description`, `startDate`, `endDate`, ...
  6. `challenge_participants`: поля `challengeId`, `userId`, `progress`, ...
  7. `feed_posts` (записи в ленте): поля `id`, `userId`, `ritualId` (или `challengeId`), `content`, `timestamp`, ...
  8. `reactions`: поля `id`, `postId`, `userId`, `emoji`, `timestamp`, ...
  9. `comments`: поля `id`, `postId`, `userId`, `text`, `timestamp`, ...

---

## 5. Пользовательские потоки (User Flows)

1. **Новый пользователь**:
   1. Устанавливает приложение.
   2. Проходит экран «Onboarding» (краткая презентация).
   3. Регистрируется (email/пароль или соцсеть).
   4. Переходит в главный экран — ему предлагается создать первый ритуал (шаблон или кастом).

2. **Создание ритуала**:
   1. Нажимает «+» на главном экране или в разделе «Мои ритуалы».
   2. Заполняет название, время, частоту.
   3. Сохраняет — ритуал появляется в «Сегодняшнем списке» в нужное время.

3. **Выполнение ритуала**:
   1. Получает пуш-уведомление (по желанию).
   2. Открывает приложение, видит ритуал в списке.
   3. Выполняет действие и отмечает «Выполнено».
   4. Получает очки, которые добавляются к общему счёту.
   5. Может оставить комментарий, чтобы увидеть реакцию друзей или подписчиков.

4. **Реакция на чужой ритуал**:
   1. Открывает ленту, видит, что кто-то выполнил ритуал.
   2. Жмёт на иконку «реакции» и выбирает эмодзи.
   3. По желанию оставляет короткий комментарий (до 140 символов).

5. **Получение достижений**:
   1. Пользователь достигает определённого показателя (например, 7 дней подряд).
   2. Приложение автоматически создаёт пост в ленте, что пользователь получил бейдж.
   3. Другие пользователи могут отреагировать.

6. **Участие в челлендже**:
   1. Переходит на экран «Челленджи», выбирает интересующий.
   2. Жмёт «Присоединиться».
   3. Выполняет условия челленджа, получает промежуточные/финальные награды.

---

## 6. Требования к производительности и надёжности

1. **Производительность**: 
   - Приложение должно быстро загружать список ритуалов и последние посты (использовать пагинацию или lazy loading).
   - Уведомления должны приходить не позже, чем за 1–2 секунды после события (ограничения пуш-сервисов).

2. **Надёжность**:
   - При отсутствии интернет-соединения пользователь может отмечать ритуал как выполненный в офлайн-режиме, данные сохраняются локально и синхронизируются при появлении сети.
   - Регулярные бэкапы базы данных.

3. **Безопасность**:
   - Хранение паролей в виде хеша (bcrypt, Argon2 или аналоги).
   - При работе с платёжной информацией (покупка Premium) — использование безопасных SDK магазинов (Google Play, App Store) или сторонних платёжных шлюзов.

---

## 7. Планы по развитию (Roadmap)

1. **MVP (Минимально жизнеспособный продукт)**:
   - Регистрация/авторизация, создание ритуалов, отметка выполнения.
   - Счёт очков, базовые достижения (streak).
   - Простая лента (только записи о выполнении, без комментариев).

2. **Версия 1.1**:
   - Добавление реакции (эмодзи) и комментариев.
   - Улучшенная лента (фильтры).
   - Блок «Челленджи» с базовой функциональностью.

3. **Версия 1.2**:
   - Расширенные достижения (разные уровни, привязка к разным ритуалам).
   - Сообщества по интересам (группы).
   - Продвинутая статистика (графики, анализ прогресса).

4. **Версия 2.0**:
   - Премиум-подписка (расширенные функции, кастомизация профиля).
   - Глобальные события (сезонные челленджи, сотрудничество с брендами).
   - Оптимизация производительности и UX-улучшения.

---

## 8. Заключение

Приложение **MicroRituals** сочетает в себе:
- Простоту создания и отслеживания ритуалов.
- Игровые механики (очки, достижения, челленджи).
- Социальное вовлечение (реакции, комментарии, лента).

Данное решение отвечает современному спросу на инструменты саморазвития и поддерживает активное вовлечение пользователей за счёт социальной составляющей и геймификации.

**Документ подготовлен в качестве технического задания (requirements.md).**
